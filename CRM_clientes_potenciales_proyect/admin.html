<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRM Admin - Panel de AdministraciÃ³n</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header admin-theme">
            <div class="header-left">
                <h1>CRM Admin</h1>
                <span class="user-role">Administrador</span>
            </div>
            <div class="header-right">
                <span id="userInfo">Admin User</span>
                <button id="logoutBtn" class="btn btn-secondary">Cerrar SesiÃ³n</button>
            </div>
        </header>

        <!-- Sidebar -->
        <aside class="admin-sidebar">
            <div class="sidebar-header">
                <h3>Panel Admin</h3>
            </div>
            <nav class="sidebar-nav">
                <button class="sidebar-btn active" data-section="crm-section">
                    <span class="sidebar-icon">ðŸ“Š</span>
                    <span class="sidebar-text">CRM</span>
                </button>
                <button class="sidebar-btn" data-section="user-section">
                    <span class="sidebar-icon">ðŸ‘¥</span>
                    <span class="sidebar-text">Usuarios</span>
                </button>
            </nav>
        </aside>

        <!-- CRM Section -->
        <div id="crm-section" class="main-section active">
            <!-- Navigation -->
            <nav class="main-nav admin-nav">
                <ul>
                    <li><a href="#dashboard" class="nav-link active" data-section="dashboard">Dashboard</a></li>
                    <li><a href="#general" class="nav-link" data-section="general">General</a></li>
                    <li><a href="#advisor-management" class="nav-link" data-section="advisor-management">Asesores</a></li>
                    <li><a href="#calendar" class="nav-link" data-section="calendar">Calendario</a></li>
                    <li><a href="#leads" class="nav-link" data-section="leads">Leads</a></li>
                    <li><a href="#clients" class="nav-link" data-section="clients">Clientes</a></li>
                </ul>
            </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Dashboard Section -->
            <section id="dashboard" class="content-section active">
                <h2>Dashboard Administrativo</h2>
                <div class="dashboard-controls">
                    <div class="manager-filter">
                        <label for="managerFilter">Filtrar por Gerente:</label>
                        <select id="managerFilter">
                            <option value="all">Todos los Gerentes</option>
                        </select>
                    </div>
                </div>

                <!-- Vista por Gerentes -->
                <div id="managersDashboard" class="managers-dashboard">
                    <h3>ðŸ“ˆ Rendimiento por Gerente de Ventas</h3>
                    <div class="managers-grid" id="managersGrid">
                        <!-- Los indicadores por gerente se cargarÃ¡n dinÃ¡micamente -->
                    </div>
                </div>

                <!-- Resumen de Cumplimiento de KPIs -->
                <div class="kpis-summary-section">
                    <h3>ðŸ“Š Resumen de Cumplimiento de KPIs</h3>
                    <div class="kpis-summary-grid" id="kpisSummaryGrid">
                        <!-- Los KPIs de asesores se cargarÃ¡n dinÃ¡micamente -->
                    </div>
                </div>

                <!-- AnÃ¡lisis de IA del Equipo -->
                <div class="ai-analysis-section">
                    <div class="ai-analysis-header">
                        <h3>ðŸ¤– AnÃ¡lisis de IA del Equipo</h3>
                        <button id="generateTeamAIAnalysis" class="btn btn-ai">
                            <span class="ai-icon">ðŸ§ </span>
                            Generar AnÃ¡lisis
                        </button>
                    </div>
                    <div class="ai-analysis-content" id="teamAIAnalysisContent">
                        <div class="ai-analysis-placeholder">
                            <div class="ai-placeholder-icon">ðŸ¤–</div>
                            <h4>AnÃ¡lisis de IA Disponible</h4>
                            <p>Haz click en "Generar AnÃ¡lisis" para obtener insights inteligentes sobre el rendimiento del equipo, tendencias de ventas y recomendaciones estratÃ©gicas.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- General Section -->
            <section id="general" class="content-section">
                <h2>MÃ©tricas Generales</h2>
                
                <!-- Filtros de rango de fechas para MÃ©tricas Generales -->
                <div class="dashboard-controls" style="margin-top: 0; margin-bottom: 1rem;">
                    <div class="manager-filter">
                        <label for="generalStartMonth">Mes Inicio:</label>
                        <select id="generalStartMonth">
                            <option value="1" selected>Enero</option>
                            <option value="2">Febrero</option>
                            <option value="3">Marzo</option>
                            <option value="4">Abril</option>
                            <option value="5">Mayo</option>
                            <option value="6">Junio</option>
                            <option value="7">Julio</option>
                            <option value="8">Agosto</option>
                            <option value="9">Septiembre</option>
                            <option value="10">Octubre</option>
                            <option value="11">Noviembre</option>
                            <option value="12">Diciembre</option>
                        </select>
                    </div>
                    <div class="manager-filter">
                        <label for="generalStartYear">AÃ±o Inicio:</label>
                        <select id="generalStartYear">
                            <!-- AÃ±os se poblarÃ¡n vÃ­a JS -->
                        </select>
                    </div>
                    <div class="manager-filter">
                        <label for="generalEndMonth">Mes Final:</label>
                        <select id="generalEndMonth">
                            <option value="1">Enero</option>
                            <option value="2">Febrero</option>
                            <option value="3">Marzo</option>
                            <option value="4">Abril</option>
                            <option value="5" selected>Mayo</option>
                            <option value="6">Junio</option>
                            <option value="7">Julio</option>
                            <option value="8">Agosto</option>
                            <option value="9">Septiembre</option>
                            <option value="10">Octubre</option>
                            <option value="11">Noviembre</option>
                            <option value="12">Diciembre</option>
                        </select>
                    </div>
                    <div class="manager-filter">
                        <label for="generalEndYear">AÃ±o Final:</label>
                        <select id="generalEndYear">
                            <!-- AÃ±os se poblarÃ¡n vÃ­a JS -->
                        </select>
                    </div>
                </div>

            <!-- Tarjetas de MÃ©tricas Generales -->
            <div class="general-metrics-cards" style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 1rem; margin-bottom: 2rem;">
                <div class="metric-card" style="background: #fff; border-radius: 12px; padding: 0; box-shadow: 0 4px 12px rgba(0,0,0,0.1); display: flex; align-items: center; min-height: 100px;">
                    <div style="width: 6px; height: 100%; background: #3B82F6; border-radius: 12px 0 0 12px; flex-shrink: 0;"></div>
                    <div style="flex: 1; padding: 1rem; text-align: center;">
                        <div style="color: #374151; font-size: 0.9rem; font-weight: 600; margin-bottom: 0.3rem;">Total Ventas</div>
                        <div id="totalSalesCount" style="color: #6B7280; font-size: 2rem; font-weight: 700;">92</div>
                    </div>
                </div>

                <div class="metric-card" style="background: #fff; border-radius: 12px; padding: 0; box-shadow: 0 4px 12px rgba(0,0,0,0.1); display: flex; align-items: center; min-height: 100px;">
                    <div style="width: 6px; height: 100%; background: #3B82F6; border-radius: 12px 0 0 12px; flex-shrink: 0;"></div>
                    <div style="flex: 1; padding: 1rem; text-align: center;">
                        <div style="color: #374151; font-size: 0.9rem; font-weight: 600; margin-bottom: 0.3rem;">Total Perdidos</div>
                        <div id="totalLostCount" style="color: #6B7280; font-size: 2rem; font-weight: 700;">25</div>
                    </div>
                </div>

                <div class="metric-card" style="background: #fff; border-radius: 12px; padding: 0; box-shadow: 0 4px 12px rgba(0,0,0,0.1); display: flex; align-items: center; min-height: 100px;">
                    <div style="width: 6px; height: 100%; background: #3B82F6; border-radius: 12px 0 0 12px; flex-shrink: 0;"></div>
                    <div style="flex: 1; padding: 1rem; text-align: center;">
                        <div style="color: #374151; font-size: 0.9rem; font-weight: 600; margin-bottom: 0.3rem;">Clientes Prospectos</div>
                        <div id="totalProspectsCount" style="color: #6B7280; font-size: 2rem; font-weight: 700;">125</div>
                    </div>
                </div>

                <div class="metric-card" style="background: #fff; border-radius: 12px; padding: 0; box-shadow: 0 4px 12px rgba(0,0,0,0.1); display: flex; align-items: center; min-height: 100px;">
                    <div style="width: 6px; height: 100%; background: #3B82F6; border-radius: 12px 0 0 12px; flex-shrink: 0;"></div>
                    <div style="flex: 1; padding: 1rem; text-align: center;">
                        <div style="color: #374151; font-size: 0.9rem; font-weight: 600; margin-bottom: 0.3rem;">Tasa de ConversiÃ³n</div>
                        <div id="conversionRate" style="color: #6B7280; font-size: 2rem; font-weight: 700;">38.0%</div>
                    </div>
                </div>
            </div>

                <!-- Tabla de MÃ©tricas Mensuales -->
                <div class="general-metrics-table" style="background: #fff; border: 1px solid var(--border-color); border-radius: 12px; padding: 1rem; box-shadow: 0 2px 8px rgba(0,0,0,0.06); margin-bottom: 2rem;">
                    <h3 style="margin: 0 0 1rem 0; color: var(--text-primary);">ðŸ“Š MÃ©tricas por Mes</h3>
                    <div style="overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse;">
                            <thead>
                                <tr style="background: #f8fafc; border-bottom: 1px solid var(--border-color);">
                                    <th style="padding: 0.75rem; text-align: left; font-weight: 600; color: var(--text-primary);">Mes</th>
                                    <th style="padding: 0.75rem; text-align: center; font-weight: 600; color: var(--text-primary);">Ventas</th>
                                    <th style="padding: 0.75rem; text-align: center; font-weight: 600; color: var(--text-primary);">Perdidos</th>
                                    <th style="padding: 0.75rem; text-align: center; font-weight: 600; color: var(--text-primary);">Prospectos</th>
                                    <th style="padding: 0.75rem; text-align: center; font-weight: 600; color: var(--text-primary);">Tasa ConversiÃ³n</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td style="padding: 0.75rem; font-weight: 600; color: var(--text-primary);">Enero 2025</td>
                                    <td style="padding: 0.75rem; text-align: center; color: #059669; font-weight: 600;">12</td>
                                    <td style="padding: 0.75rem; text-align: center; color: #dc2626; font-weight: 600;">3</td>
                                    <td style="padding: 0.75rem; text-align: center; color: #d97706; font-weight: 600;">18</td>
                                    <td style="padding: 0.75rem; text-align: center; color: #059669; font-weight: 600;">36.4%</td>
                                </tr>
                                <tr style="background: #f8fafc;">
                                    <td style="padding: 0.75rem; font-weight: 600; color: var(--text-primary);">Febrero 2025</td>
                                    <td style="padding: 0.75rem; text-align: center; color: #059669; font-weight: 600;">15</td>
                                    <td style="padding: 0.75rem; text-align: center; color: #dc2626; font-weight: 600;">5</td>
                                    <td style="padding: 0.75rem; text-align: center; color: #d97706; font-weight: 600;">22</td>
                                    <td style="padding: 0.75rem; text-align: center; color: #059669; font-weight: 600;">35.7%</td>
                                </tr>
                                <tr>
                                    <td style="padding: 0.75rem; font-weight: 600; color: var(--text-primary);">Marzo 2025</td>
                                    <td style="padding: 0.75rem; text-align: center; color: #059669; font-weight: 600;">18</td>
                                    <td style="padding: 0.75rem; text-align: center; color: #dc2626; font-weight: 600;">4</td>
                                    <td style="padding: 0.75rem; text-align: center; color: #d97706; font-weight: 600;">25</td>
                                    <td style="padding: 0.75rem; text-align: center; color: #059669; font-weight: 600;">38.3%</td>
                                </tr>
                                <tr style="background: #f8fafc;">
                                    <td style="padding: 0.75rem; font-weight: 600; color: var(--text-primary);">Abril 2025</td>
                                    <td style="padding: 0.75rem; text-align: center; color: #059669; font-weight: 600;">22</td>
                                    <td style="padding: 0.75rem; text-align: center; color: #dc2626; font-weight: 600;">6</td>
                                    <td style="padding: 0.75rem; text-align: center; color: #d97706; font-weight: 600;">28</td>
                                    <td style="padding: 0.75rem; text-align: center; color: #059669; font-weight: 600;">39.3%</td>
                                </tr>
                                <tr>
                                    <td style="padding: 0.75rem; font-weight: 600; color: var(--text-primary);">Mayo 2025</td>
                                    <td style="padding: 0.75rem; text-align: center; color: #059669; font-weight: 600;">25</td>
                                    <td style="padding: 0.75rem; text-align: center; color: #dc2626; font-weight: 600;">7</td>
                                    <td style="padding: 0.75rem; text-align: center; color: #d97706; font-weight: 600;">32</td>
                                    <td style="padding: 0.75rem; text-align: center; color: #059669; font-weight: 600;">39.1%</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Espacio para GrÃ¡fico de LÃ­neas de MÃ©tricas Generales -->
                <div style="background: #fff; border: 1px solid var(--border-color); border-radius: 12px; padding: 1rem; box-shadow: 0 2px 8px rgba(0,0,0,0.06);">
                    <h3 style="margin: 0 0 1rem 0; color: var(--text-primary);">ðŸ“ˆ EvoluciÃ³n de MÃ©tricas Generales</h3>
                    <div style="height: 300px; display: flex; align-items: center; justify-content: center; color: #64748b; font-size: 1.1rem; border: 2px dashed #e2e8f0; border-radius: 8px;">
                        Espacio reservado para grÃ¡fico
                    </div>
                </div>
            </section>

            <!-- Advisor Management Section -->
            <section id="advisor-management" class="content-section">
                <!-- Pantalla 1: EstadÃ­sticas por Asesor -->
                <div id="advisor-stats-screen" class="advisor-screen active">
                    <h3>EstadÃ­sticas por Asesor</h3>

                    <!-- Filtros de tiempo para EstadÃ­sticas por Asesor -->
                    <div class="dashboard-controls" style="margin-top: 0; margin-bottom: 1rem;">
                        <div class="manager-filter">
                            <label for="advisorStartMonth">Mes Inicio:</label>
                            <select id="advisorStartMonth">
                                <option value="1">Enero</option>
                                <option value="2">Febrero</option>
                                <option value="3">Marzo</option>
                                <option value="4">Abril</option>
                                <option value="5">Mayo</option>
                                <option value="6">Junio</option>
                                <option value="7">Julio</option>
                                <option value="8">Agosto</option>
                                <option value="9">Septiembre</option>
                                <option value="10">Octubre</option>
                                <option value="11">Noviembre</option>
                                <option value="12">Diciembre</option>
                            </select>
                        </div>
                        <div class="manager-filter">
                            <label for="advisorStartYear">AÃ±o Inicio:</label>
                            <select id="advisorStartYear">
                                <!-- AÃ±os se poblarÃ¡n vÃ­a JS -->
                            </select>
                        </div>
                        <div class="manager-filter">
                            <label for="advisorEndMonth">Mes Final:</label>
                            <select id="advisorEndMonth">
                                <option value="1">Enero</option>
                                <option value="2">Febrero</option>
                                <option value="3">Marzo</option>
                                <option value="4">Abril</option>
                                <option value="5">Mayo</option>
                                <option value="6">Junio</option>
                                <option value="7">Julio</option>
                                <option value="8">Agosto</option>
                                <option value="9">Septiembre</option>
                                <option value="10">Octubre</option>
                                <option value="11">Noviembre</option>
                                <option value="12">Diciembre</option>
                            </select>
                        </div>
                        <div class="manager-filter">
                            <label for="advisorEndYear">AÃ±o Final:</label>
                            <select id="advisorEndYear">
                                <!-- AÃ±os se poblarÃ¡n vÃ­a JS -->
                            </select>
                        </div>
                    </div>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <h4>Total de Asesores</h4>
                            <div class="stat-value" id="totalAdvisors">0</div>
                        </div>
                        <div class="stat-card">
                            <h4>Leads Asignados</h4>
                            <div class="stat-value" id="totalAssignedLeads">0</div>
                        </div>
                        <div class="stat-card">
                            <h4>Conversiones del Equipo</h4>
                            <div class="stat-value" id="teamConversions">0</div>
                        </div>
                        <div class="stat-card">
                            <h4>Tasa de ConversiÃ³n</h4>
                            <div class="stat-value" id="teamConversionRate">0%</div>
                        </div>
                    </div>
                    
                    <div class="table-container">
                        <h4>EstadÃ­sticas Detalladas por Asesor</h4>
                        <table class="data-table" id="advisorStatsTable">
                            <thead>
                                <tr>
                                    <th>Asesor</th>
                                    <th>Leads Asignados</th>
                                    <th>Acciones Realizadas</th>
                                    <th>Conversiones</th>
                                    <th>Tasa ConversiÃ³n</th>
                                    <th>Leads Activos</th>
                                    <th>Ãšltima Actividad</th>
                                </tr>
                            </thead>
                            <tbody id="advisorStatsTableBody">
                                <!-- Los datos se cargarÃ¡n dinÃ¡micamente -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>


            

            <!-- Calendar Section -->
            <section id="calendar" class="content-section">
                <h2>Calendario del Equipo</h2>
                
                <!-- Controles del Calendario -->
                <div class="calendar-controls">
                    <button id="prevWeek" class="btn btn-secondary">â€¹ Semana Anterior</button>
                    <button id="todayBtn" class="btn btn-outline">Hoy</button>
                    <span id="currentWeek" class="week-display"></span>
                    <button id="nextWeek" class="btn btn-secondary">Siguiente Semana â€º</button>
                    <button id="createEventBtn" class="btn btn-primary">+ Crear Evento</button>
                </div>
                
                <!-- Calendario Semanal -->
                <div class="weekly-calendar-container">
                    <div class="calendar-header">
                        <div class="day-header">Hora</div>
                        <div class="day-header">Lunes</div>
                        <div class="day-header">Martes</div>
                        <div class="day-header">MiÃ©rcoles</div>
                        <div class="day-header">Jueves</div>
                        <div class="day-header">Viernes</div>
                        <div class="day-header">SÃ¡bado</div>
                        <div class="day-header">Domingo</div>
                    </div>
                    <div class="calendar-grid" id="teamCalendar">
                        <!-- El calendario se generarÃ¡ dinÃ¡micamente -->
                    </div>
                </div>
                
                <!-- Resumen de Tareas del Equipo -->
                <div class="team-tasks-summary">
                    <h3>Resumen de Tareas del Equipo</h3>
                    <div class="tasks-summary-grid" id="tasksSummary">
                        <!-- Las tareas se cargarÃ¡n dinÃ¡micamente -->
                    </div>
                </div>
            </section>

            <!-- Leads Section -->
            <section id="leads" class="content-section">
                <h2>EstadÃ­sticas de Leads</h2>
                
                <!-- Filtros de tiempo para estadÃ­sticas -->
                <div class="dashboard-controls">
                    <div class="manager-filter">
                        <label for="leadsStartMonth">Mes Inicio:</label>
                        <select id="leadsStartMonth">
                            <option value="1">Enero</option>
                            <option value="2">Febrero</option>
                            <option value="3">Marzo</option>
                            <option value="4">Abril</option>
                            <option value="5">Mayo</option>
                            <option value="6">Junio</option>
                            <option value="7">Julio</option>
                            <option value="8">Agosto</option>
                            <option value="9">Septiembre</option>
                            <option value="10">Octubre</option>
                            <option value="11">Noviembre</option>
                            <option value="12">Diciembre</option>
                        </select>
                    </div>
                    <div class="manager-filter">
                        <label for="leadsStartYear">AÃ±o Inicio:</label>
                        <select id="leadsStartYear">
                            <!-- AÃ±os se poblarÃ¡n vÃ­a JS -->
                        </select>
                    </div>
                    <div class="manager-filter">
                        <label for="leadsEndMonth">Mes Final:</label>
                        <select id="leadsEndMonth">
                            <option value="1">Enero</option>
                            <option value="2">Febrero</option>
                            <option value="3">Marzo</option>
                            <option value="4">Abril</option>
                            <option value="5">Mayo</option>
                            <option value="6">Junio</option>
                            <option value="7">Julio</option>
                            <option value="8">Agosto</option>
                            <option value="9">Septiembre</option>
                            <option value="10">Octubre</option>
                            <option value="11">Noviembre</option>
                            <option value="12">Diciembre</option>
                        </select>
                    </div>
                    <div class="manager-filter">
                        <label for="leadsEndYear">AÃ±o Final:</label>
                        <select id="leadsEndYear">
                            <!-- AÃ±os se poblarÃ¡n vÃ­a JS -->
                        </select>
                    </div>
                </div>

                <!-- EstadÃ­sticas de Leads por PerÃ­odo -->
                <div class="leads-stats-container">
                    <div class="leads-stats-cards">
                        <div class="stat-card primary">
                            <h4>Total Leads</h4>
                            <div class="stat-value" id="totalLeadsCount">0</div>
                        </div>
                        <div class="stat-card success">
                            <h4>Leads Convertidos</h4>
                            <div class="stat-value" id="convertedLeadsCount">0</div>
                        </div>
                        <div class="stat-card warning">
                            <h4>Leads Activos</h4>
                            <div class="stat-value" id="activeLeadsCount">0</div>
                        </div>
                        <div class="stat-card danger">
                            <h4>Leads Perdidos</h4>
                            <div class="stat-value" id="lostLeadsCount">0</div>
                        </div>
                        <div class="stat-card info">
                            <h4>Tasa ConversiÃ³n</h4>
                            <div class="stat-value" id="leadsConversionRate">0%</div>
                        </div>
                        <div class="stat-card secondary">
                            <h4>Promedio Mensual</h4>
                            <div class="stat-value" id="monthlyAverage">0</div>
                        </div>
                    </div>
                </div>

                <!-- Tabla de estadÃ­sticas por mes/aÃ±o -->
                <div class="leads-stats-table">
                    <h3>EstadÃ­sticas Detalladas</h3>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>PerÃ­odo</th>
                                <th>Total Leads</th>
                                <th>Convertidos</th>
                                <th>Activos</th>
                                <th>Perdidos</th>
                                <th>Tasa ConversiÃ³n</th>
                            </tr>
                        </thead>
                        <tbody id="leadsStatsTableBody">
                            <!-- Los datos se cargarÃ¡n dinÃ¡micamente -->
                        </tbody>
                    </table>
                </div>

                <!-- GrÃ¡fico de estadÃ­sticas -->
                <div class="chart-container">
                    <canvas id="leadsStatsChart"></canvas>
                </div>
            </section>


            <!-- Clients Section -->
            <section id="clients" class="content-section">
                <h2>EstadÃ­sticas de Clientes</h2>
                
                <!-- Filtros de tiempo para estadÃ­sticas de clientes -->
                <div class="dashboard-controls">
                    <div class="manager-filter">
                        <label for="clientsStartMonth">Mes Inicio:</label>
                        <select id="clientsStartMonth">
                            <option value="1">Enero</option>
                            <option value="2">Febrero</option>
                            <option value="3">Marzo</option>
                            <option value="4">Abril</option>
                            <option value="5">Mayo</option>
                            <option value="6">Junio</option>
                            <option value="7">Julio</option>
                            <option value="8">Agosto</option>
                            <option value="9">Septiembre</option>
                            <option value="10">Octubre</option>
                            <option value="11">Noviembre</option>
                            <option value="12">Diciembre</option>
                        </select>
                    </div>
                    <div class="manager-filter">
                        <label for="clientsStartYear">AÃ±o Inicio:</label>
                        <select id="clientsStartYear">
                            <!-- AÃ±os se poblarÃ¡n vÃ­a JS -->
                        </select>
                    </div>
                    <div class="manager-filter">
                        <label for="clientsEndMonth">Mes Final:</label>
                        <select id="clientsEndMonth">
                            <option value="1">Enero</option>
                            <option value="2">Febrero</option>
                            <option value="3">Marzo</option>
                            <option value="4">Abril</option>
                            <option value="5">Mayo</option>
                            <option value="6">Junio</option>
                            <option value="7">Julio</option>
                            <option value="8">Agosto</option>
                            <option value="9">Septiembre</option>
                            <option value="10">Octubre</option>
                            <option value="11">Noviembre</option>
                            <option value="12">Diciembre</option>
                        </select>
                    </div>
                    <div class="manager-filter">
                        <label for="clientsEndYear">AÃ±o Final:</label>
                        <select id="clientsEndYear">
                            <!-- AÃ±os se poblarÃ¡n vÃ­a JS -->
                        </select>
                    </div>
                </div>

                <!-- EstadÃ­sticas de Clientes por PerÃ­odo -->
                <div class="clients-stats-container">
                    <div class="clients-stats-cards">
                        <div class="stat-card primary">
                            <h4>Total Clientes</h4>
                            <div class="stat-value" id="totalClientsCount">0</div>
                        </div>
                        <div class="stat-card success">
                            <h4>Clientes Fidelizados</h4>
                            <div class="stat-value" id="fidelizedClientsCount">0</div>
                        </div>
                        <div class="stat-card warning">
                            <h4>Clientes Potenciales</h4>
                            <div class="stat-value" id="potentialClientsCount">0</div>
                        </div>
                        <div class="stat-card info">
                            <h4>Clientes Activos</h4>
                            <div class="stat-value" id="activeClientsCount">0</div>
                        </div>
                        <div class="stat-card danger">
                            <h4>Clientes Perdidos</h4>
                            <div class="stat-value" id="lostClientsCount">0</div>
                        </div>
                        <div class="stat-card secondary">
                            <h4>Tasa FidelizaciÃ³n</h4>
                            <div class="stat-value" id="fidelizationRate">0%</div>
                        </div>
                    </div>
                </div>

                <!-- Tabla de estadÃ­sticas por mes/aÃ±o -->
                <div class="clients-stats-table">
                    <h3>EstadÃ­sticas Detalladas</h3>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>PerÃ­odo</th>
                                <th>Total Clientes</th>
                                <th>Fidelizados</th>
                                <th>Potenciales</th>
                                <th>Activos</th>
                                <th>Perdidos</th>
                                <th>Tasa FidelizaciÃ³n</th>
                            </tr>
                        </thead>
                        <tbody id="clientsStatsTableBody">
                            <!-- Los datos se cargarÃ¡n dinÃ¡micamente -->
                        </tbody>
                    </table>
                </div>

                <!-- GrÃ¡fico de estadÃ­sticas -->
                <div class="chart-container">
                    <canvas id="clientsStatsChart"></canvas>
                </div>
            </section>
        </main>
        </div>

        <!-- User Management Section -->
        <div id="user-section" class="main-section">
            <div class="user-section-header">
                <h2>GestiÃ³n de Usuarios</h2>
                <p>Administra usuarios, roles y permisos del sistema</p>
            </div>
            
            <div class="user-management-container">
                <!-- Formulario de CreaciÃ³n de Usuario -->
                <div class="user-form-card">
                    <div class="card-header">
                        <h3>Crear Nuevo Usuario</h3>
                        <p>Registra nuevos gerentes de ventas y asesores en el sistema</p>
                    </div>
                    
                    <form id="userCreationForm" class="user-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="userFirstName">Nombres:</label>
                                <input type="text" id="userFirstName" name="firstName" required placeholder="Ej: Juan Carlos">
                            </div>
                            
                            <div class="form-group">
                                <label for="userLastName">Apellidos:</label>
                                <input type="text" id="userLastName" name="lastName" required placeholder="Ej: PÃ©rez GarcÃ­a">
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="userCedula">NÃºmero de CÃ©dula:</label>
                                <input type="text" id="userCedula" name="cedula" required placeholder="Ej: 1234567890" maxlength="10">
                            </div>
                            
                            <div class="form-group">
                                <label for="userRole">Rol del Usuario:</label>
                                <select id="userRole" name="role" required onchange="window.crm.toggleManagerSelection()">
                                    <option value="">Seleccionar rol...</option>
                                    <option value="manager">Gerente de Ventas</option>
                                    <option value="advisor">Asesor</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="userEmail">Correo ElectrÃ³nico:</label>
                                <input type="email" id="userEmail" name="email" required placeholder="Ej: juan.perez@empresa.com">
                            </div>
                            
                            <div class="form-group">
                                <label for="userPhone">TelÃ©fono:</label>
                                <input type="tel" id="userPhone" name="phone" required placeholder="Ej: +57 300 123 4567">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="userAddress">DirecciÃ³n:</label>
                            <textarea id="userAddress" name="address" required placeholder="Ej: Calle 123 #45-67, Barrio Centro, Ciudad" rows="3"></textarea>
                        </div>
                        
                        <div class="form-group" id="managerSelectionGroup" style="display: none;">
                            <label for="userManager">Asignar a Gerente de Ventas:</label>
                            <select id="userManager" name="managerId">
                                <option value="">Seleccionar gerente...</option>
                            </select>
                            <small style="color: #6c757d; margin-top: 0.25rem; display: block;">
                                Selecciona el gerente de ventas que supervisarÃ¡ a este asesor
                            </small>
                        </div>
                        
                        <div class="form-group" id="advisorSelectionGroup" style="display: none;">
                            <label for="userAdvisors">Asignar Asesores:</label>
                            <div id="availableAdvisorsList" class="advisors-checkbox-list">
                                <!-- Los asesores disponibles se cargarÃ¡n dinÃ¡micamente -->
                            </div>
                            <small style="color: #6c757d; margin-top: 0.25rem; display: block;">
                                Selecciona los asesores que estarÃ¡n bajo tu supervisiÃ³n
                            </small>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="userUsername">Nombre de Usuario:</label>
                                <input type="text" id="userUsername" name="username" required placeholder="Ej: jperez" minlength="3">
                            </div>
                            
                            <div class="form-group">
                                <label for="userPassword">ContraseÃ±a Temporal:</label>
                                <input type="password" id="userPassword" name="password" required placeholder="MÃ­nimo 6 caracteres" minlength="6">
                            </div>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="btn btn-secondary" id="resetUserForm">Limpiar Formulario</button>
                            <button type="submit" class="btn btn-primary">
                                <span class="icon">ðŸ‘¤</span>
                                Crear Usuario
                            </button>
                        </div>
                    </form>
                </div>
                
                <!-- Lista de Usuarios Existentes -->
                <div class="users-list-card">
                    <div class="card-header">
                        <h3>Usuarios Registrados</h3>
                        <span class="user-count" id="userCount">0 usuarios</span>
                    </div>
                    
                    <!-- Filtros de Usuarios -->
                    <div class="users-filters">
                        <select id="usersRoleFilter">
                            <option value="">Todos los Roles</option>
                            <option value="admin">Administrador</option>
                            <option value="manager">Gerente de Ventas</option>
                            <option value="advisor">Asesor</option>
                        </select>
                        <button onclick="window.crm.loadUsers()" class="btn btn-primary">Actualizar Lista</button>
                    </div>
                    
                    <!-- SecciÃ³n de Administradores -->
                    <div class="user-section">
                        <div class="user-section-header">
                            <h4>ðŸ‘‘ Administradores</h4>
                            <span class="section-count" id="adminCount">0 administradores</span>
                        </div>
                        <div id="adminUsersList" class="users-grid">
                            <!-- Los administradores se cargarÃ¡n dinÃ¡micamente -->
                        </div>
                    </div>
                    
                    <!-- SecciÃ³n de Gerentes -->
                    <div class="user-section">
                        <div class="user-section-header">
                            <h4>ðŸ‘” Gerentes de Ventas</h4>
                            <span class="section-count" id="managerCount">0 gerentes</span>
                        </div>
                        <div id="managerUsersList" class="users-grid">
                            <!-- Los gerentes se cargarÃ¡n dinÃ¡micamente -->
                        </div>
                    </div>
                    
                    <!-- SecciÃ³n de Asesores -->
                    <div class="user-section">
                        <div class="user-section-header">
                            <h4>ðŸ‘¤ Asesores</h4>
                            <span class="section-count" id="advisorCount">0 asesores</span>
                        </div>
                        <div id="advisorUsersList" class="users-grid">
                            <!-- Los asesores se cargarÃ¡n dinÃ¡micamente -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div id="leadDetailModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="leadDetailTitle">Detalle del Lead</h3>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body" id="leadDetailContent">
                <!-- Lead details will be populated here -->
            </div>
        </div>
    </div>

    <div id="advisorDetailModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="advisorDetailTitle">Detalle del Asesor</h3>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body" id="advisorDetailContent">
                <!-- Advisor details will be populated here -->
            </div>
        </div>
    </div>

    <div id="sequenceDetailModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="sequenceDetailTitle">Detalle de Secuencia</h3>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body" id="sequenceDetailContent">
                <!-- Sequence details will be populated here -->
            </div>
        </div>
    </div>

    <!-- Modal de AsignaciÃ³n MÃºltiple de Asesores -->
    <div id="assignAdvisorsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Asignar Secuencia a Asesores</h3>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <div class="assignment-info">
                    <h4 id="assignmentSequenceName"></h4>
                    <p>Selecciona los asesores a los que quieres asignar esta secuencia:</p>
                </div>
                
                <div class="advisors-selection">
                    <div class="selection-controls">
                        <button type="button" id="selectAllAdvisors" class="btn btn-outline btn-sm">Seleccionar Todos</button>
                        <button type="button" id="deselectAllAdvisors" class="btn btn-outline btn-sm">Deseleccionar Todos</button>
                    </div>
                    
                    <div id="advisorsList" class="advisors-checkbox-list">
                        <!-- Lista de asesores con checkboxes -->
                    </div>
                </div>
                
                <div class="current-assignments">
                    <h5>Asignaciones Actuales:</h5>
                    <div id="currentAssignmentsList" class="current-assignments-list">
                        <!-- Lista de asesores actualmente asignados -->
                    </div>
                </div>
                
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="cancelAssignment">Cancelar</button>
                    <button type="button" class="btn btn-primary" id="saveAssignments">Guardar Asignaciones</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para Crear Evento -->
    <div id="createEventModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Crear Nuevo Evento</h3>
                <span class="close" onclick="window.crm.closeCreateEventModal()">&times;</span>
            </div>
            <div class="modal-body">
                <form id="createEventForm">
                    <div class="form-group">
                        <label for="eventTitle">TÃ­tulo del Evento:</label>
                        <input type="text" id="eventTitle" name="title" required placeholder="Ej: ReuniÃ³n de equipo">
                    </div>
                    <div class="form-group">
                        <label for="eventDescription">DescripciÃ³n:</label>
                        <textarea id="eventDescription" name="description" placeholder="DescripciÃ³n del evento..."></textarea>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="eventDate">Fecha:</label>
                            <input type="date" id="eventDate" name="date" required>
                        </div>
                        <div class="form-group">
                            <label for="eventTime">Hora:</label>
                            <input type="time" id="eventTime" name="time" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="eventDuration">DuraciÃ³n (minutos):</label>
                        <input type="number" id="eventDuration" name="duration" min="15" max="480" value="60" required>
                    </div>
                    <div class="form-group">
                        <label for="eventAdvisor">Asignar a Asesor:</label>
                        <select id="eventAdvisor" name="advisor">
                            <option value="">Todos los asesores</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="eventType">Tipo de Evento:</label>
                        <select id="eventType" name="type" required>
                            <option value="meeting">ReuniÃ³n</option>
                            <option value="call">Llamada</option>
                            <option value="task">Tarea</option>
                            <option value="reminder">Recordatorio</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="window.crm.closeCreateEventModal()">Cancelar</button>
                <button type="button" class="btn btn-primary" onclick="window.crm.saveEvent()">Crear Evento</button>
            </div>
        </div>
    </div>

    <!-- Modal de Detalle de Usuario -->
    <div id="userDetailModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="userDetailTitle">Detalle del Usuario</h3>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body" id="userDetailContent">
                <!-- User details will be populated here -->
            </div>
        </div>
    </div>

    <!-- Modal de EdiciÃ³n de Usuario -->
    <div id="editUserModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Editar Usuario</h3>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <form id="editUserForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="editUserFirstName">Nombres:</label>
                            <input type="text" id="editUserFirstName" name="firstName" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="editUserLastName">Apellidos:</label>
                            <input type="text" id="editUserLastName" name="lastName" required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="editUserCedula">NÃºmero de CÃ©dula:</label>
                            <input type="text" id="editUserCedula" name="cedula" required maxlength="10">
                        </div>
                        
                        <div class="form-group">
                            <label for="editUserRole">Rol del Usuario:</label>
                            <select id="editUserRole" name="role" required onchange="window.crm.toggleEditManagerSelection()">
                                <option value="manager">Gerente de Ventas</option>
                                <option value="advisor">Asesor</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="editUserEmail">Correo ElectrÃ³nico:</label>
                            <input type="email" id="editUserEmail" name="email" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="editUserPhone">TelÃ©fono:</label>
                            <input type="tel" id="editUserPhone" name="phone" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="editUserAddress">DirecciÃ³n:</label>
                        <textarea id="editUserAddress" name="address" required rows="3"></textarea>
                    </div>
                    
                    <div class="form-group" id="editManagerSelectionGroup" style="display: none;">
                        <label for="editUserManager">Asignar a Gerente de Ventas:</label>
                        <select id="editUserManager" name="managerId">
                            <option value="">Seleccionar gerente...</option>
                        </select>
                        <small style="color: #6c757d; margin-top: 0.25rem; display: block;">
                            Selecciona el gerente de ventas que supervisarÃ¡ a este asesor
                        </small>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="editUserUsername">Nombre de Usuario:</label>
                            <input type="text" id="editUserUsername" name="username" required minlength="3">
                        </div>
                        
                        <div class="form-group">
                            <label for="editUserPassword">Nueva ContraseÃ±a (opcional):</label>
                            <input type="password" id="editUserPassword" name="password" placeholder="Dejar vacÃ­o para mantener la actual" minlength="6">
                        </div>
                    </div>
                    
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" onclick="window.crm.closeEditUserModal()">Cancelar</button>
                        <button type="submit" class="btn btn-primary">Guardar Cambios</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal para Detalles de Tarea/Evento -->
    <div id="taskDetailModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="taskDetailTitle">Detalle de Tarea/Evento</h3>
                <span class="close" onclick="window.crm.closeTaskDetailModal()">&times;</span>
            </div>
            <div class="modal-body" id="taskDetailContent">
                <!-- Los detalles se cargarÃ¡n dinÃ¡micamente -->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="window.crm.closeTaskDetailModal()">Cerrar</button>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
    <script>
        // Initialize admin interface
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM cargado, inicializando admin...');
            if (window.crm && typeof window.crm.initManager === 'function') {
                // Llamar initManager pero permitir que funcione para admin tambiÃ©n
                window.crm.initManagerForAdmin();
            } else {
                console.error('CRM App no estÃ¡ disponible');
            }
        });
    </script>
</body>
</html>

